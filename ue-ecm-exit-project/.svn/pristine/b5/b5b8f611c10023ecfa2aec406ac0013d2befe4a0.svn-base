/*
* This code was generated by the persistence code generator
* Copyright 2000-2008 by Emptoris, Inc.,
* Backing pod: C:/Emptoris_Complete/eclipse_workspace/rMCCS_new/ue-ecm-exit-project/src/main/java/com/emptoris/ecm/exit/persistence/MccsNonAmendmentContractSerialNumber.pod
*/

/******************************************************************************/
/* MCCS_CUSTOM_TB_NONAMDPersister.java                                        */
/******************************************************************************/
package persistence;
import com.dicarta.infra.persistence.server.*;
import com.dicarta.infra.persistence.common.exception.*;
import com.dicarta.infra.persistence.common.databeans.*;
import com.dicarta.infra.persistence.common.iterator.*;
import persistence.*;
import java.util.*;
import java.sql.*;
import java.math.*;
import com.dicarta.infra.logging.*;

/******************************************************************************/
/* class: MCCS_CUSTOM_TB_NONAMDPersister                                      */
/******************************************************************************/
public class MCCS_CUSTOM_TB_NONAMDPersister extends AbstractJDBCPersister implements IMCCS_CUSTOM_TB_NONAMDPersister {
    private static final ILogger m_log = Logger.getLogger(MCCS_CUSTOM_TB_NONAMDPersister.class);
    private static MCCS_CUSTOM_TB_NONAMDPersister m_mCCS_CUSTOM_TB_NONAMDPersister = new MCCS_CUSTOM_TB_NONAMDPersister();

    /**************************************************************************/
    /* constructor                                                            */
    /**************************************************************************/
    public MCCS_CUSTOM_TB_NONAMDPersister() {
    }

    /**************************************************************************/
    /* getInstance                                                            */
    /**************************************************************************/
    public static MCCS_CUSTOM_TB_NONAMDPersister getInstance() {
        return m_mCCS_CUSTOM_TB_NONAMDPersister;
    }

    /**************************************************************************/
    /* getCreateStmt                                                          */
    /**************************************************************************/
    protected final PreparedStatement getCreateStmt(IPersistentData data) throws PersistenceException {
        try {
            PseudoPreparedStatement ps = new PseudoPreparedStatement(getConnection(),MCCS_CUSTOM_TB_NONAMDPersister.getCreateSQL() );
            MCCSCustomNonAmdSerialNumber mCCSCustomNonAmdSerialNumber = (MCCSCustomNonAmdSerialNumber)data;
            ps.setString(1, mCCSCustomNonAmdSerialNumber.getCOMPANY_ID());
            ps.setInt(2, mCCSCustomNonAmdSerialNumber.getYEAR());
            ps.setString(3, mCCSCustomNonAmdSerialNumber.getCONTRACT_TYPE());
            ps.setInt(4, mCCSCustomNonAmdSerialNumber.getSERIAL_NUMBER());
            return ps;
        }
        catch(Exception e) {
            m_log.error("Exception in getCreateStmt", e);
            throw new PersistenceException(this, "getCreateStmt", e.toString());
        }
    }

    /**************************************************************************/
    /* getCreateSQL                                                           */
    /**************************************************************************/
    private static final String _getCreateSQL = "insert into MCCS_CUSTOM_TB_NONAMD(COMPANY_ID,YEAR,CONTRACT_TYPE,SERIAL_NUM) values (?,?,?,?)";
    public static final String getCreateSQL() {
        return _getCreateSQL;
    }

    /**************************************************************************/
    /* getUpdateStmt                                                          */
    /**************************************************************************/
    protected final PreparedStatement getUpdateStmt(IPersistentData data) throws PersistenceException {
        try {
            PseudoPreparedStatement ps = new PseudoPreparedStatement(getConnection(),MCCS_CUSTOM_TB_NONAMDPersister.getUpdateSQL() );
            MCCSCustomNonAmdSerialNumber mCCSCustomNonAmdSerialNumber = (MCCSCustomNonAmdSerialNumber)data;
            ps.setString(1, mCCSCustomNonAmdSerialNumber.getCOMPANY_ID());
            ps.setInt(2, mCCSCustomNonAmdSerialNumber.getYEAR());
            ps.setString(3, mCCSCustomNonAmdSerialNumber.getCONTRACT_TYPE());
            return ps;
        }
        catch(Exception e) {
            m_log.error("Exception in getUpdateStmt", e);
            throw new PersistenceException(this, "getUpdateStmt", e.toString());
        }
    }

    /**************************************************************************/
    /* getUpdateSQL                                                           */
    /**************************************************************************/
    private static final String _getUpdateSQL = "update MCCS_CUSTOM_TB_NONAMD set SERIAL_NUM = SERIAL_NUM+1 where COMPANY_ID=? AND YEAR=? AND CONTRACT_TYPE=? ";
    public static final String getUpdateSQL() {
        return _getUpdateSQL;
    }

    /**************************************************************************/
    /* getSerialNum                                                           */
    /**************************************************************************/
    public IDataIterator getSerialNum(MCCSCustomNonAmdSerialNumber mCCSCustomNonAmdSerialNumber) throws PersistenceException {
        try {
            return new SerialNumByComibinationIterator(mCCSCustomNonAmdSerialNumber);
        }
        catch(Exception e) {
            m_log.error("Exception in getSerialNum", e);
            throw new PersistenceException(this, "getSerialNum", e.toString());
        }
    }

    /**************************************************************************/
    /* getGetSerialNumSQL                                                     */
    /**************************************************************************/
    private static final String _getGetSerialNumSQL = "select distinct COMPANY_ID,YEAR,CONTRACT_TYPE,SERIAL_NUM from MCCS_CUSTOM_TB_NONAMD where COMPANY_ID=? AND YEAR=? AND CONTRACT_TYPE=?";
    public static final String getGetSerialNumSQL() {
        return _getGetSerialNumSQL;
    }

    /**************************************************************************/
    /* populateDataBean                                                       */
    /**************************************************************************/
    protected final IPersistentData populateDataBean(ResultSet rs) throws PersistenceException, SQLException {
        MCCSCustomNonAmdSerialNumber data = new MCCSCustomNonAmdSerialNumber();
        data.setCOMPANY_ID(rs.getString(1));
        data.setYEAR(rs.getInt(2));
        data.setCONTRACT_TYPE(rs.getString(3));
        data.setSERIAL_NUMBER(rs.getInt(4));
        return (IPersistentData)data;
    }
}
