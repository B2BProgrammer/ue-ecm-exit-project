/*
* This code was generated by the persistence code generator
* Copyright 2000-2008 by Emptoris, Inc.,
* Backing pod: C:/Emptoris_Complete/eclipse_workspace/rMCCS_new/ue-ecm-exit-project/src/main/java/com/emptoris/ecm/exit/persistence/MCCS_Contract_Name.pod
*/

/******************************************************************************/
/* MCCS_CONTRACT_NAMEPersister.java                                           */
/******************************************************************************/
package persistence;
import com.dicarta.infra.persistence.server.*;
import com.dicarta.infra.persistence.common.exception.*;
import com.dicarta.infra.persistence.common.databeans.*;
import com.dicarta.infra.persistence.common.iterator.*;
import persistence.*;
import java.util.*;
import java.sql.*;
import java.math.*;
import com.dicarta.infra.logging.*;

/******************************************************************************/
/* class: MCCS_CONTRACT_NAMEPersister                                         */
/******************************************************************************/
public class MCCS_CONTRACT_NAMEPersister extends AbstractJDBCPersister implements IMCCS_CONTRACT_NAMEPersister {
    private static final ILogger m_log = Logger.getLogger(MCCS_CONTRACT_NAMEPersister.class);
    private static MCCS_CONTRACT_NAMEPersister m_mCCS_CONTRACT_NAMEPersister = new MCCS_CONTRACT_NAMEPersister();

    /**************************************************************************/
    /* constructor                                                            */
    /**************************************************************************/
    public MCCS_CONTRACT_NAMEPersister() {
    }

    /**************************************************************************/
    /* getInstance                                                            */
    /**************************************************************************/
    public static MCCS_CONTRACT_NAMEPersister getInstance() {
        return m_mCCS_CONTRACT_NAMEPersister;
    }

    /**************************************************************************/
    /* getContractNamesFunction                                               */
    /**************************************************************************/
    public IDataIterator getContractNamesFunction(String sqlFrom) throws PersistenceException {
        try {
            return new SeqContractNameIterator(sqlFrom);
        }
        catch(Exception e) {
            m_log.error("Exception in getContractNamesFunction", e);
            throw new PersistenceException(this, "getContractNamesFunction", e.toString());
        }
    }

    /**************************************************************************/
    /* getGetContractNamesFunctionSQL                                         */
    /**************************************************************************/
    private static final String _getGetContractNamesFunctionSQL = "select CONTRACT_NAME,CONTRACT_NUMBER,TRANSACTION_DATE from  MCCS_CONTRACT_NAME";
    public static final String getGetContractNamesFunctionSQL() {
        return _getGetContractNamesFunctionSQL;
    }

    /**************************************************************************/
    /* getMatchingCombinations                                                */
    /**************************************************************************/
    public IDataIterator getMatchingCombinations(String sqlWhere) throws PersistenceException {
        try {
            return new SeqContractNameIterator(sqlWhere);
        }
        catch(Exception e) {
            m_log.error("Exception in getMatchingCombinations", e);
            throw new PersistenceException(this, "getMatchingCombinations", e.toString());
        }
    }

    /**************************************************************************/
    /* getGetMatchingCombinationsSQL                                          */
    /**************************************************************************/
    private static final String _getGetMatchingCombinationsSQL = "select CONTRACT_NAME,CONTRACT_NUMBER,TRANSACTION_DATE from  MCCS_CONTRACT_NAME";
    public static final String getGetMatchingCombinationsSQL() {
        return _getGetMatchingCombinationsSQL;
    }

    /**************************************************************************/
    /* getCreateStmt                                                          */
    /**************************************************************************/
    protected final PreparedStatement getCreateStmt(IPersistentData data) throws PersistenceException {
        try {
            PseudoPreparedStatement ps = new PseudoPreparedStatement(getConnection(),MCCS_CONTRACT_NAMEPersister.getCreateSQL() );
            MCCSContractName mCCSContractName = (MCCSContractName)data;
            ps.setString(1, mCCSContractName.getContractname());
            ps.setInt(2, mCCSContractName.getContractnumber());
            if(mCCSContractName.getTransactiondate() != null) {
                ps.setTimestamp(3, new java.sql.Timestamp(mCCSContractName.getTransactiondate().getTime()));
            }
            else {
                ps.setTimestamp(3, null);
            }
            return ps;
        }
        catch(Exception e) {
            m_log.error("Exception in getCreateStmt", e);
            throw new PersistenceException(this, "getCreateStmt", e.toString());
        }
    }

    /**************************************************************************/
    /* getCreateSQL                                                           */
    /**************************************************************************/
    private static final String _getCreateSQL = "insert into MCCS_Contract_Name(CONTRACT_NAME,CONTRACT_NUMBER,TRANSACTION_DATE) values (?,?,?)";
    public static final String getCreateSQL() {
        return _getCreateSQL;
    }

    /**************************************************************************/
    /* populateDataBean                                                       */
    /**************************************************************************/
    protected final IPersistentData populateDataBean(ResultSet rs) throws PersistenceException, SQLException {
        MCCSContractName data = new MCCSContractName();
        data.setContractname(rs.getString(1));
        data.setContractnumber(rs.getInt(2));
        if(rs.getTimestamp(3) != null) {
                data.setTransactiondate(new java.util.Date(rs.getTimestamp(3).getTime()));
            }else {
                data.setTransactiondate(null);
            }
        return (IPersistentData)data;
    }
}
